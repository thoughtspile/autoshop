!function(n){function e(s){if(t[s])return t[s].exports;var o=t[s]={i:s,l:!1,exports:{}};return n[s].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var t={};return e.m=n,e.c=t,e.i=function(n){return n},e.d=function(n,t,s){e.o(n,t)||Object.defineProperty(n,t,{configurable:!1,enumerable:!0,get:s})},e.n=function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(t,"a",t),t},e.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},e.p="",e(e.s=7)}([function(module,exports,__webpack_require__){"use strict";eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar json = function json(url, method, obj) {\n  return $.ajax({\n    url: url,\n    type: method,\n    data: obj || {},\n    dataType: 'json'\n  });\n};\n\nexports.default = {\n  get: function get(url) {\n    return $.ajax(url);\n  },\n  post: function post(url, obj) {\n    return json(url, 'POST', obj);\n  },\n  del: function del(url, obj) {\n    return json(url, 'DELETE', obj);\n  }\n};\n\n//////////////////\n// WEBPACK FOOTER\n// ./public/js/src/adapter.js\n// module id = 0\n// module chunks = 0\n\n//# sourceURL=webpack:///./public/js/src/adapter.js?")},function(module,exports,__webpack_require__){"use strict";eval("\n\nvar _adapter = __webpack_require__(0);\n\nvar _adapter2 = _interopRequireDefault(_adapter);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar reloadStats = function reloadStats() {\n  return window.stats && window.stats.reload();\n};\n\nVue.component('addtocart', {\n  template: '\\n    <form class=\\'order input-group\\' method=\\'post\\' v-on:click.stop.prevent=\"\">\\n      <span v-if=\"isInCart\" class=\"input-group-addon\">\\u0412 \\u043A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0435:</span>\\n      <input\\n        v-on:change=\"setQtyLive\"\\n        name=\\'qty\\'\\n        type=\\'number\\'\\n        min=\"1\"\\n        :value=\"qty\"\\n        class=\"form-control\"\\n      ></input>\\n      <span v-if=\"!isInCart\" class=\"input-group-btn\">\\n        <button type=\"submit\" class=\\'btn btn-default order__btn\\' v-on:click.stop.prevent=\"setQty\">\\n          \\u041A\\u0443\\u043F\\u0438\\u0442\\u044C\\n        </button>\\n      </span>\\n    </form>\\n  ',\n  props: ['goodId', 'value'],\n  data: function data() {\n    var value = Number(this.value);\n    var isInCart = !!value;\n    return { qty: isInCart ? value : 1, isInCart: isInCart };\n  },\n\n  methods: {\n    setQty: function setQty() {\n      var _this = this;\n\n      _adapter2.default.post('/api/cart', { good_id: this.goodId, qty: this.qty }).then(function (res) {\n        return res.goods.forEach(function (good) {\n          if (good.good === _this.goodId) {\n            _this.qty = good.qty;\n            _this.isInCart = !!good.qty;\n          }\n        });\n      }).then(reloadStats);\n    },\n    setQtyLive: function setQtyLive(e) {\n      this.qty = e.target.value;\n      if (this.isInCart) {\n        this.setQty();\n      }\n    }\n  }\n});\nif (document.getElementById('goods')) {\n  new Vue({ el: '#goods' });\n}\n\n//////////////////\n// WEBPACK FOOTER\n// ./public/js/src/addtocart.js\n// module id = 1\n// module chunks = 0\n\n//# sourceURL=webpack:///./public/js/src/addtocart.js?")},function(module,exports,__webpack_require__){"use strict";eval("\n\nvar _adapter = __webpack_require__(0);\n\nvar _adapter2 = _interopRequireDefault(_adapter);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar cart = null;\n\nvar reloadStats = function reloadStats() {\n  window.stats && window.stats.reload();\n};\n\nvar handleContent = function handleContent(_ref) {\n  var goods = _ref.goods;\n  cart.goods = goods;reloadStats();\n};\nvar handleUser = function handleUser(_ref2) {\n  var user = _ref2.user;\n  cart.user = user;\n};\nvar handleShops = function handleShops(_ref3) {\n  var shops = _ref3.shops;\n\n  cart.shops = shops;\n  cart.options.shop = cart.options.shop || cart.shops[0]._id;\n};\nvar register = function register() {\n  if (cart.user.isAnonymous && cart.user.email && cart.user.password) {\n    _adapter2.default.post('/api/user/me', cart.user).then(handleUser);\n  }\n};\nvar changeQty = function changeQty(item, e) {\n  _adapter2.default.post('/api/cart', { good_id: item.good, qty: e.target.value }).then(handleContent);\n};\nvar removeItem = function removeItem(item) {\n  _adapter2.default.del('/api/cart', { good_id: item.good }).then(handleContent);\n};\n\nif (document.getElementById('vue--cart')) {\n  cart = new Vue({\n    el: '#vue--cart',\n    data: {\n      goods: [],\n      shops: [],\n      options: {\n        deliv: 'shop',\n        shop: null,\n        addr: '',\n        comment: ''\n      },\n      user: {\n        email: '',\n        password: '',\n        isAnonymous: false,\n        about: 'private',\n        name: ''\n      },\n      password: ''\n    },\n    delimiters: ['${', '}'],\n    methods: {\n      changeQty: changeQty,\n      removeItem: removeItem,\n      register: register\n    },\n    computed: {\n      total: function total() {\n        return this.goods.reduce(function (sum, g) {\n          return sum + g.goodData.price * g.qty;\n        }, 0);\n      }\n    }\n  });\n\n  _adapter2.default.get('/api/cart/').then(handleContent);\n  _adapter2.default.get('/api/shops/').then(handleShops);\n  _adapter2.default.get('/api/user/me').then(handleUser);\n\n  window.cart = cart;\n}\n\n//////////////////\n// WEBPACK FOOTER\n// ./public/js/src/cart.js\n// module id = 2\n// module chunks = 0\n\n//# sourceURL=webpack:///./public/js/src/cart.js?")},function(module,exports,__webpack_require__){"use strict";eval("\n\nvar _adapter = __webpack_require__(0);\n\nvar _adapter2 = _interopRequireDefault(_adapter);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar stats = new Vue({\n  el: '#vue--header-cart',\n  template: '\\n    <span>\\n      <div v-if=\"!isEmpty\" class=\"cart-stats\">\\n        <div class=\"cart-logo\"></div>\\n        <div class=\"cart-stats-count\">{{count}} {{plural}}</div>\\n        <div class=\"cart-stats-total\">{{total}} \\u0440\\u0443\\u0431.</div>\\n      </div>\\n    </span>\\n  ',\n  data: {\n    total: 0,\n    count: 0\n  },\n  methods: {\n    reload: function reload() {\n      var _this = this;\n\n      _adapter2.default.get('/api/stats/').then(function (res) {\n        _this.total = res.total;\n        _this.count = res.count;\n      });\n    }\n  },\n  computed: {\n    isEmpty: function isEmpty() {\n      return this.count === 0;\n    },\n    plural: function plural() {\n      var count = this.count;\n      var last_1 = count % 10;\n      var last_2 = count % 100;\n      if (last_1 === 1 && last_2 !== 11) {\n        return 'товар';\n      }\n      if ([2, 3, 4].indexOf(last_1) !== -1 && [12, 13, 14].indexOf(last_2) === -1) {\n        return 'товара';\n      }\n      return 'товаров';\n    }\n  }\n});\n\nstats.reload();\n\nwindow.stats = stats;\n\n//////////////////\n// WEBPACK FOOTER\n// ./public/js/src/header-cart.js\n// module id = 3\n// module chunks = 0\n\n//# sourceURL=webpack:///./public/js/src/header-cart.js?")},function(module,exports,__webpack_require__){"use strict";eval("\n\n__webpack_require__(6);\n\nvar _adapter = __webpack_require__(0);\n\nvar _adapter2 = _interopRequireDefault(_adapter);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nif (typeof L !== 'undefined') {\n  (function () {\n    var mymap = L.map('mapid').setView([55.7558, 37.6173], 8);\n    L.tileLayer('https://api.mapbox.com/styles/v1/klepov/ciuo3rqmf00g62inogy2c5v2v/tiles/256/{z}/{x}/{y}?access_token={accessToken}', {\n      maxZoom: 18,\n      accessToken: 'pk.eyJ1Ijoia2xlcG92IiwiYSI6ImNpanZvOTZ0ajAwNGl3OGphcnQwdzVweG4ifQ.jCM8K6R_MxlX92wgz0IMqw',\n      sleepNote: true,\n      sleepOpacity: 0.9\n    }).addTo(mymap);\n\n    _adapter2.default.get('/api/shops').then(function (res) {\n      res.shops.forEach(function (shop) {\n        var template = '\\n        <div class=\"shop-map-popup\">\\n          <h2>' + shop.type + ' \\xAB' + shop.name + '\\xBB</h2>\\n          <div>\\u0410\\u0434\\u0440\\u0435\\u0441: ' + shop.address + '</div>\\n          <div style=\"margin-top: 4px; margin-bottom: 4px\">\\u0422\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D: ' + shop.phone + '</div>\\n          \\u0423\\u0441\\u043B\\u0443\\u0433\\u0438:\\n          <ul>\\n            ' + shop.features.map(function (f) {\n          return '<li>' + f + '</li>';\n        }).join('') + '\\n          </ul>\\n          <a href=\"/shops/' + shop._id + '\">\\u041F\\u043E\\u0434\\u0440\\u043E\\u0431\\u043D\\u0435\\u0435</a>\\n        </div>';\n        var marker = L.marker([shop.lat, shop.lon]).addTo(mymap);\n        var needPopup = document.getElementsByClassName('intro__promo-copy').length !== 0;\n        if (needPopup) {\n          marker.on('click', function () {\n            $('.leaflet-marker-icon').css({ filter: 'none' });\n            $(this.getElement()).css({ filter: 'brightness(150%)' });\n            $('.intro__promo-copy').html(template);\n          });\n        } else {\n          marker.bindPopup(template);\n        }\n      });\n    });\n  })();\n}\n\n//////////////////\n// WEBPACK FOOTER\n// ./public/js/src/map.js\n// module id = 4\n// module chunks = 0\n\n//# sourceURL=webpack:///./public/js/src/map.js?")},function(module,exports,__webpack_require__){"use strict";eval("\n\n(function () {\n    $('.popup-holder').each(function () {\n        var popupBody = $('.popup', this);\n        var popupCtrl = $('.popup-control', this);\n        popupCtrl.on('click', function () {\n            popupBody.toggleClass('hide');\n        });\n    });\n})();\n\n//////////////////\n// WEBPACK FOOTER\n// ./public/js/src/signin-popup.js\n// module id = 5\n// module chunks = 0\n\n//# sourceURL=webpack:///./public/js/src/signin-popup.js?")},function(module,exports,__webpack_require__){"use strict";eval("\n\nif (typeof L !== 'undefined') {\n  L.Map.mergeOptions({\n    sleep: true,\n    sleepTime: 750,\n    wakeTime: 750,\n    sleepNote: true,\n    hoverToWake: true\n  });\n\n  L.Map.Sleep = L.Handler.extend({\n    addHooks: function addHooks() {\n      this.sleepNote = L.DomUtil.create('p', 'sleep-note', this._map._container);\n      this._sleepMap();\n      this._enterTimeout = null;\n      this._exitTimeout = null;\n\n      var noteString = 'Click ' + (this._map.options.hoverToWake ? 'or Hover ' : '') + 'to Wake',\n          style = this.sleepNote.style;\n      if (this._map.options.sleepNote) {\n        this.sleepNote.appendChild(document.createTextNode(noteString));\n        style['max-width'] = '150px';\n        style.opacity = '.6';\n        style.margin = 'auto';\n        style['text-align'] = 'center';\n        style['border-radius'] = '4px';\n        style.top = '50%';\n        style.position = 'relative';\n        style.padding = '5px';\n        style.border = 'solid 2px black';\n        style.background = 'white';\n      }\n    },\n\n    removeHooks: function removeHooks() {\n      if (!this._map.scrollWheelZoom.enabled()) {\n        this._map.scrollWheelZoom.enable();\n      }\n      L.DomUtil.setOpacity(this._map._container, 1);\n      L.DomUtil.setOpacity(this.sleepNote, 0);\n      this._removeSleepingListeners();\n      this._removeAwakeListeners();\n    },\n\n    _wakeMap: function _wakeMap() {\n      this._stopWaiting();\n      this._map.scrollWheelZoom.enable();\n      L.DomUtil.setOpacity(this._map._container, 1);\n      this.sleepNote.style.opacity = 0;\n      this._addAwakeListeners();\n    },\n\n    _sleepMap: function _sleepMap() {\n      this._stopWaiting();\n      this._map.scrollWheelZoom.disable();\n      L.DomUtil.setOpacity(this._map._container, .7);\n      this.sleepNote.style.opacity = .4;\n      this._addSleepingListeners();\n    },\n\n    _wakePending: function _wakePending() {\n      this._map.once('click', this._wakeMap, this);\n      if (this._map.options.hoverToWake) {\n        var self = this;\n        this._map.once('mouseout', this._sleepMap, this);\n        self._enterTimeout = setTimeout(function () {\n          self._map.off('mouseout', self._sleepMap, self);\n          self._wakeMap();\n        }, self._map.options.wakeTime);\n      }\n    },\n\n    _sleepPending: function _sleepPending() {\n      var self = this;\n      self._map.once('mouseover', self._wakeMap, self);\n      self._exitTimeout = setTimeout(function () {\n        self._map.off('mouseover', self._wakeMap, self);\n        self._sleepMap();\n      }, self._map.options.sleepTime);\n    },\n\n    _addSleepingListeners: function _addSleepingListeners() {\n      this._map.once('mouseover', this._wakePending, this);\n    },\n\n    _addAwakeListeners: function _addAwakeListeners() {\n      this._map.once('mouseout', this._sleepPending, this);\n    },\n\n    _removeSleepingListeners: function _removeSleepingListeners() {\n      this._map.options.hoverToWake && this._map.off('mouseover', this._wakePending, this);\n      this._map.off('mousedown click', this._wakeMap, this);\n    },\n\n    _removeAwakeListeners: function _removeAwakeListeners() {\n      this._map.off('mouseout', this._sleepPending, this);\n    },\n\n    _stopWaiting: function _stopWaiting() {\n      this._removeSleepingListeners();\n      this._removeAwakeListeners();\n      var self = this;\n      if (this._enterTimeout) clearTimeout(self._enterTimeout);\n      if (this._exitTimeout) clearTimeout(self._exitTimeout);\n      this._enterTimeout = null;\n      this._exitTimeout = null;\n    }\n  });\n\n  L.Map.addInitHook('addHandler', 'sleep', L.Map.Sleep);\n}\n\n//////////////////\n// WEBPACK FOOTER\n// ./public/js/src/Leaflet.Sleep.js\n// module id = 6\n// module chunks = 0\n\n//# sourceURL=webpack:///./public/js/src/Leaflet.Sleep.js?")},function(module,exports,__webpack_require__){eval("__webpack_require__(1);\n__webpack_require__(2);\n__webpack_require__(3);\n__webpack_require__(5);\nmodule.exports = __webpack_require__(4);\n\n\n//////////////////\n// WEBPACK FOOTER\n// multi ./public/js/src/addtocart.js ./public/js/src/cart.js ./public/js/src/header-cart.js ./public/js/src/signin-popup.js ./public/js/src/map.js\n// module id = 7\n// module chunks = 0\n\n//# sourceURL=webpack:///multi_./public/js/src/addtocart.js_./public/js/src/cart.js_./public/js/src/header-cart.js_./public/js/src/signin-popup.js_./public/js/src/map.js?")}]);